<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>What is Gitleaks and how to use it? | akashchandwani.github.io</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Gitleaks is an open source tool used to detect and prevent secrets (passwords / api-keys) checked-in to your git repository. The main advantage of Gitleaks is that it not only scans your latest source code but also the entire git history identifying any secrets committed to your source code in the past as well.
&ldquo;Once your secrets are committed, assume it’s leaked.&rdquo;
&ldquo;Use gitleaks before a hacker uses it to exploit you…&rdquo; — Your friend at open source">
    <meta name="generator" content="Hugo 0.104.1" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    
    
    
      

    

    
    
    <meta property="og:title" content="What is Gitleaks and how to use it?" />
<meta property="og:description" content="Gitleaks is an open source tool used to detect and prevent secrets (passwords / api-keys) checked-in to your git repository. The main advantage of Gitleaks is that it not only scans your latest source code but also the entire git history identifying any secrets committed to your source code in the past as well.
&ldquo;Once your secrets are committed, assume it’s leaked.&rdquo;
&ldquo;Use gitleaks before a hacker uses it to exploit you…&rdquo; — Your friend at open source" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://akashchandwani.github.io/posts/what-is-gitleaks/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-28T23:19:43+05:30" />
<meta property="article:modified_time" content="2022-09-28T23:19:43+05:30" />

<meta itemprop="name" content="What is Gitleaks and how to use it?">
<meta itemprop="description" content="Gitleaks is an open source tool used to detect and prevent secrets (passwords / api-keys) checked-in to your git repository. The main advantage of Gitleaks is that it not only scans your latest source code but also the entire git history identifying any secrets committed to your source code in the past as well.
&ldquo;Once your secrets are committed, assume it’s leaked.&rdquo;
&ldquo;Use gitleaks before a hacker uses it to exploit you…&rdquo; — Your friend at open source"><meta itemprop="datePublished" content="2022-09-28T23:19:43+05:30" />
<meta itemprop="dateModified" content="2022-09-28T23:19:43+05:30" />
<meta itemprop="wordCount" content="1269">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="What is Gitleaks and how to use it?"/>
<meta name="twitter:description" content="Gitleaks is an open source tool used to detect and prevent secrets (passwords / api-keys) checked-in to your git repository. The main advantage of Gitleaks is that it not only scans your latest source code but also the entire git history identifying any secrets committed to your source code in the past as well.
&ldquo;Once your secrets are committed, assume it’s leaked.&rdquo;
&ldquo;Use gitleaks before a hacker uses it to exploit you…&rdquo; — Your friend at open source"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        akashchandwani.github.io
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        POSTS
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">What is Gitleaks and how to use it?</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2022-09-28T23:19:43+05:30">September 28, 2022</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>Gitleaks is an open source tool used to detect and prevent secrets (passwords / api-keys) checked-in to your git repository. The main advantage of Gitleaks is that it not only scans your latest source code but also the entire git history identifying any secrets committed to your source code in the past as well.</p>
<p>&ldquo;Once your secrets are committed, assume it’s leaked.&rdquo;</p>
<p>&ldquo;Use gitleaks before a hacker uses it to exploit you…&rdquo; — Your friend at open source</p>
<h1 id="how-to-use-gitleaks">How to use Gitleaks?</h1>
<p>Before you can use Gitleaks, you will need to install it. There are several ways to install it. We will cover the best installation option according to the scenarios discussed below. Here is a list of all available options if you want to visit it now.</p>
<p>There are several scenarios where you would find Gitleaks useful. I have listed down the most common scenarios below:</p>
<h1 id="scenario-1">Scenario 1:</h1>
<p>Everything is committed in my git source code repository and I want to find if there are/were any secrets committed.</p>
<p>This is the most common scenario if you want to detect any secrets committed to your git source code repository. For this, you can:</p>
<ol>
<li>Install gitleaks on your system.</li>
<li>Mac users can install gitleaks via homebrew using the command — brew install gitleaks .</li>
<li>Windows and Linux users can visit the release page of Gitleaks here and download and install the appropriate version from there.</li>
<li>Open terminal and go to the source code repository you want to detect secrets from. cd <!-- raw HTML omitted --></li>
<li>Run the following command to find if there are secrets committed in your git repository — gitleaks detect .</li>
<li>Run the following command to find the details of secrets committed in your git repository — gitleaks detect -v</li>
</ol>
<p>If you have found some secrets in your source code repository and you want to erase them, there are several tools that can help you. BFG repo cleaner is one of them. I will be soon writing a separate blog on how to use this tool…</p>
<h1 id="scenario-2">Scenario 2:</h1>
<p>I want to make sure that I don’t commit any secret in my git source code repository</p>
<p>There is a famous saying — “Prevention is better than cure”. Similarly it’s better to protect your repository from accidental leaks rather than cleaning it later. For this, you can:</p>
<ol>
<li>Install gitleaks on your system. (Refer step 1 in scenario 1)</li>
<li>Open terminal and go to the source code repository you want to inspect for any secrets. cd <!-- raw HTML omitted --></li>
<li>Run the following command to find any secrets in your code changes — gitleaks protect . (Note: Secrets in untracked files are not detected in this step)</li>
<li>Run the following command to find the details the secrets in your code changes— gitleaks protect -v</li>
<li>Remove any secrets that were detected in step 3 and step 4.</li>
<li>Move your code changes to staging area by using the command — git add <!-- raw HTML omitted --> .</li>
<li>Use git add . to move all code changes to the staging area.</li>
<li>Run the following command to find if there are any secrets in the staging area in your git repository — gitleaks protect &ndash;staged</li>
<li>Run the following command to find the details if there are secrets in the staging area — gitleaks protect &ndash;staged -v</li>
<li>If there were any secrets detected in step 7 and step 8. Remove the secrets and add the changes back to the staging area.</li>
</ol>
<h1 id="scenario-3">Scenario 3:</h1>
<p>I want to automate the process of checking secret in my code changes in before I commit it</p>
<p>In this scenario, what we want to automate the process mentioned in scenario 2. As a human we are prone to making mistakes, and sometimes we might forget to check if we are adding secrets in our commits. For this, we can add gitleaks protect &ndash;staged -v command in our pre-commit hook file. Follow the steps:</p>
<ol>
<li>Install gitleaks in your system. (Refer step 1 in scenario 1)</li>
<li>Open terminal and go to the source code repository you want to inspect for any secrets. cd <!-- raw HTML omitted --></li>
<li>Rename the pre-commit.sample file in your .git/hooks folder to pre-commit using the command —
mv .git/hooks/pre-commit.sample .git/hooks/pre-commit</li>
<li>Make sure the file has executing permission by running the following command —</li>
<li>chmod +x .git/hooks/pre-commit</li>
<li>Open the pre-commit file in your preferred editor and add the following line at the end of the file —
exec gitleaks protect &ndash;staged -v</li>
</ol>
<p>Instead of step 5, you can also choose to use the pre-commit script provided by the gitleaks community. For this, replace the content in your pre-commit file with the content with this.</p>
<h1 id="scenario-4">Scenario 4:</h1>
<p>I want to make sure that my team does not check-in any secret in the source code repository</p>
<p>In the previous scenario we have automated the process of detecting secrets before it’s checked-in in your local repository. But in a more real scenario, a team works on the same source code repository and managing git-hooks in each of the individual’s machine could be cumbersome and manual process. For this, we can use a pre-commit tool for managing this configuration across developer’s machine. The steps for it are:</p>
<ol>
<li>Install pre-commit using one of the following ways mentioned here.</li>
<li>Open terminal and go to the source code repository you want to inspect for any secrets. cd <!-- raw HTML omitted --></li>
<li>Create a .pre-commit-config.yaml . Mac and linux users can use touch command for it— touch .pre-commit-config.yaml</li>
<li>Add the content into the file from here or from the code in code reference section below.</li>
<li>Update the version of gitleaks in the file using the following command — pre-commit autoupdate</li>
<li>Install the pre-commit in your pre-commit hooks using the following command — pre-commit install</li>
<li>Now when ever you commit, the pre-commit hook installed in your repository will check if any secrets are present in your changes. You will just need to make sure every of developer installs pre-commit using the step 1 and installs pre-commit using the command in step 7.</li>
</ol>
<p>Code Reference:
pre-commit-config.yml file used in step 4.
.pre-commit-config.yml file (<a href="https://gist.github.com/akashchandwani/4665bb3e211fed6197eb048ce756886a">https://gist.github.com/akashchandwani/4665bb3e211fed6197eb048ce756886a</a>)</p>
<h1 id="scenario-5">Scenario 5:</h1>
<p>What if my team mate does not update his/her pre-commit hook file and checks-in a secret</p>
<p>Well, mistakes can happen from anyone. Also, you can’t make sure if every developer in your team has updated his/her pre-commit config. They can be ignorant and not follow the steps. The best way to make sure that secrets are not checked-in is at the entry point of your remote source code repository i.e., to scan the project once anyone pushes the code to the source code repository. This can be achieved by running gitleaks detect command in your remote source code repository when ever a code is checked into the repository. This can be configured via various CI tools.</p>
<p>If your remote source code is in Github and you use Github Actions for your CI process, you can use gitleaks in Github Actions to detect any leaks from your repository.</p>
<h1 id="scenario-6">Scenario 6:</h1>
<p>I don’t use git, can I still use gitleaks to detect secrets in my source code?</p>
<p>Yes absolutely. You can use Gitleaks with any source code repository even if it’s not version controlled by git. To use gitleaks with non-git repository, use gitleaks detect with &ndash;no-git option.</p>
<ol>
<li>Install Gitleaks on your system (Refer step 1 in scenario 1)</li>
<li>Run gitleaks detect command with &ndash;no-git option —
gitleaks detect &ndash;no-git</li>
</ol>
<h1 id="conclusion">Conclusion:</h1>
<p>In this blog we have seen various scenarios on how to we can use gitleaks to detect and protect our source code from accidental leaks. In my next blog I will write on how to remove secrets from your source code repository if you have detected it. Don’t forget to follow to stay updated… :)</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://akashchandwani.github.io/" >
    &copy;  akashchandwani.github.io 2022 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
